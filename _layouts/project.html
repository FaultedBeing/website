---
layout: default
---
<article class="post project-layout">

  <header class="post-header">
    <h1 class="post-title">{{ page.title | escape }}</h1>
  </header>

  <div class="project-page-container">
    <!-- Main Content Column -->
    <div class="project-main-content">
      {% if page.image %}
        <img src="{{ page.image | relative_url }}" alt="{{ page.title }} preview" style="max-width: 100%; border-radius: 8px; margin-bottom: 2em;">
      {% endif %}

      {{ content }}

      <hr style="margin: 3em 0;">

      <h2>Project Updates</h2>
      <div class="project-updates-list">
        {% assign project_updates_all = site.project_updates | where: "project_slug", page.slug %}
        {% assign sorted_updates = project_updates_all | sort: 'date' | reverse %}
        {% for update in sorted_updates %}
          {% if update.project_slug == page.slug %}
            <a href="{{ update.url | relative_url }}" class="update-card-link">
              <article class="update-item-card">
                {% assign update_image = update.image %}
                {% if update_image == nil or update_image == '' %}
                  {% assign img_fragments = update.content | split: '<img' %}
                  {% if img_fragments.size > 1 %}
                    {% assign first_img_fragment = img_fragments[1] %}
                    {% if update_image == nil or update_image == '' %}
                      {% assign src_fragments = first_img_fragment | split: 'src="' %}
                      {% if src_fragments.size > 1 %}
                        {% assign after_src = src_fragments[1] %}
                        {% assign update_image = after_src | split: '"' | first %}
                      {% endif %}
                    {% endif %}
                    {% if update_image == nil or update_image == '' %}
                      {% assign src_fragments_single = first_img_fragment | split: "src='" %}
                      {% if src_fragments_single.size > 1 %}
                        {% assign after_src_single = src_fragments_single[1] %}
                        {% assign update_image = after_src_single | split: "'" | first %}
                      {% endif %}
                    {% endif %}
                  {% endif %}
                {% endif %}
                {% if update_image %}
                  {% if update_image contains '://' %}
                    <div class="update-card-image" style="background-image: url('{{ update_image }}')"></div>
                  {% else %}
                    <div class="update-card-image" style="background-image: url('{{ update_image | relative_url }}')"></div>
                  {% endif %}
                {% endif %}
                <div class="update-card-content">
                  <h3 class="update-title">{{ update.title }}</h3>
                  <p class="update-meta">{{ update.date | date: "%B %d, %Y" }}</p>
                </div>
              </article>
            </a>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <!-- Sidebar Column -->
    <aside class="project-sidebar">
      {% if page.list_uuid %}
        <div class="subscription-box">
          <!-- This form is now dynamically generated -->
          <form method="post" action="https://emailsettingz.maxoberg.dev/subscription/form" class="listmonk-form">
            <div>
              <h3>Follow this Project</h3>
              <p style="font-size: 0.9em; color: var(--subtle-text-color); margin-top: -0.5em; margin-bottom: 1.5em;">Get email updates for this project specifically.</p>
              <input type="hidden" name="nonce" />
              <p><input type="email" name="email" required placeholder="E-mail" /></p>
              <p>
                <!-- The list UUID is dynamically inserted here -->
                <input id="{{ page.list_uuid }}" type="hidden" name="l" checked value="{{ page.list_uuid }}" />
              </p>
              <p><input type="submit" value="Subscribe" /></p>
            </div>
          </form>
        </div>
      {% endif %}
    </aside>
  </div>

</article>
